---
title: В заказы и резервы добавлена информация о терминале, сохранившем последние изменения
layout: default
---

Новое свойство `LastChangedTerminalId` добавлено в заказ ([`IOrder`](https://iiko.github.io/front.api.sdk/v7/html/T_Resto_Front_Api_Data_Orders_IOrder.htm).[`LastChangedTerminalId`](https://iiko.github.io/front.api.sdk/v7/html/P_Resto_Front_Api_Data_Orders_IOrder_LastChangedTerminalId.htm)) и в резерв ([`IReserve`](https://iiko.github.io/front.api.sdk/v7/html/T_Resto_Front_Api_Data_Brd_IReserve.htm).[`LastChangedTerminalId`](https://iiko.github.io/front.api.sdk/v7/html/P_Resto_Front_Api_Data_Brd_IReserve_LastChangedTerminalId.htm)), оно позволяет определить, на каком терминале было сохранено текущее состояние этих объектов.

В некоторых сценариях, например, при обработке событий [`OrderChanged`](https://iiko.github.io/front.api.sdk/v7/html/P_Resto_Front_Api_INotificationService_OrderChanged.htm), [`DeliveryOrderChanged`](https://iiko.github.io/front.api.sdk/v7/html/P_Resto_Front_Api_INotificationService_DeliveryOrderChanged.htm) или [`ReserveChanged`](https://iiko.github.io/front.api.sdk/v7/html/P_Resto_Front_Api_INotificationService_ReserveChanged.htm), может возникнуть потребность отделить изменения, сохранённые на локальном терминале, от изменений, полученных по сети с соседних терминалов. Теперь для этого достаточно сравнить `LastChangedTerminalId` и `PluginContext.Operations.GetHostTerminal().Id`. 

Ранее для этих целей [был добавлен]({{ site.baseurl }}{% post_url 2019-04-12-order-edit-terminal %}) метод [`GetLastChangedOrderTerminal`](https://iiko.github.io/front.api.sdk/v6/html/M_Resto_Front_Api_IOperationService_GetLastChangedOrderTerminal.htm), возвращавший терминал, где были сохранены последние изменения указанного объекта. Однако, между получением плагином определённого состояния `IOrder` и вызовом `GetLastChangedOrderTerminal` могли быть внесены новые изменения на ином терминале, и тогда метод `GetLastChangedOrderTerminal` возвращал этот иной терминал, ориентируясь на более новое состояние `IOrder`, чем есть у плагина. Теперь такой проблемы нет, поскольку свойство `LastChangedTerminalId` плагин получает непосредственно в объекте `IOrder`. Метод `GetLastChangedOrderTerminal` удалён.