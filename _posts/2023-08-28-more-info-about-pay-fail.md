---
title: More details about pay fail
layout: default
---

The V8Preview7 API has made it even more convenient to analyze payment errors.

Methods [`PayOrder`](https://syrve.github.io/front.api.sdk/v8/html/M_Resto_Front_Api_IOperationService_PayOrder.htm) and [`PayOrderAndPayOutOnUser`](https://syrve.github.io/front.api.sdk/v8/html/M_Resto_Front_Api_IOperationService_PayOrderAndPayOutOnUser.htm)
can generate an exception [`PaymentActionFailedException`](https://syrve.github.io/front.api.sdk/v8/html/T_Resto_Front_Api_Exceptions_PaymentActionFailedException.htm)
in case an error occurred during payment processing.
At the same time, the plugin developers only had an error message at their disposal
[`Exception.Message`](https://learn.microsoft.com/en-us/dotnet/api/system.exception.message),
which is inconvenient to work with and classify.

In the new version in [`PaymentActionFailedException`](https://syrve.github.io/front.api.sdk/v8/html/T_Resto_Front_Api_Exceptions_PaymentActionFailedException.htm)
property has been added [`Reason`](https://syrve.github.io/front.api.sdk/v8/html/P_Resto_Front_Api_Exceptions_PaymentActionFailedException_Reason.htm)
â€” classifiable error cause, which cannot be `null` if the exception was thrown from the `PayOrder` or `PayOrderAndPayOutOnUser` methods.
Wherein [`Reason`](https://syrve.github.io/front.api.sdk/v8/html/P_Resto_Front_Api_Exceptions_PaymentActionFailedException_Reason.htm)
can take on the following values [`PaymentActionFailedExceptionReason`](https://syrve.github.io/front.api.sdk/v8/html/T_Resto_Front_Api_Exceptions_PaymentActionFailedExceptionReason.htm):

```
/// <summary>
/// Reason for throwing <see cref="PaymentActionFailedException"/>.
/// </summary>
[PublicAPI]
public enum PaymentActionFailedExceptionReason
{
 OrderNotFound,
 CannotLockOrder,
 OrderStatusIsNotOpened,
 BanquetOrderNotSupported,

 DeliveryOrderStatusIsUnconfirmed,
 DeliveryOrderHasPurchases,
 DeliveryOrderPrepayAndCloseOnDifferentTerminalNotSupported,

 PayInTypeIsIncorrect,
 PayOutTypeIsIncorrect,
 PayOutOnUserFailed,

 CafeSessionNotFound,
 CashRegisterNotFound,
 OnlyVirtualCashRegisterForPurchasesSupported,

 UserNotFound,
 UserPersonalSessionNotOpened,
 NoUserPermissionsToPayAsWaiter,
 NoUserPermissionsToPayOthersOrder,
 NoUserPermissionsToApprovePointsAccural,
 UserCashDrawerNotFound,

 PaymentTypeNotSpecified,
 PaymentTypeNotConfigured,
 UncombinablePaymentTypes,
 UncombinablePaymentTypesFiscalNonFiscal,
 AutomaticPaymentTypeNotFound,
 NotProcessedNotSilentPaymentsNotSupported,
 PayOrderFailed,
 CannotPrintOrder,
 CannotEditStopList,
 OrderBillOperationFailed,
 PaymentsProcessingCanceled,
 PaymentsProcessingFailed,
 BeforeDoChequeOperationFailed,
 ChequeTaskProcessorFailed,
 CashRegisterOperationFailed,

 MoreThanOnePaymentsWithChange,
 ChangeSumEqualToPaymentsWithChangeSum,
 ChangeSumGreaterThanPaymentsWithChangeSum,

 PaymentSumNotEnough,
 PaymentSumNotIntegral,
 PaymentSumTooLarge,
 CashForChangeNotEnough,

 BillOrderBeforePayment,
 SplitOrderBeforePayment,

 CookingPlacesWithEmptyStores,
 TimePayProductsInOrder,

 ChequeSmsSendingNotSupported,
 ChequeEmailSendingNotSupported,
 ChequeSettlementPlaceNotSupported,
}
```

Of which only

- `OrderBillOperationFailed`,
- `PaymentsProcessingCanceled`,
- `PaymentsProcessingFailed`,
- `BeforeDoChequeOperationFailed`,
- `ChequeTaskProcessorFailed`,
- `CashRegisterOperationFailed`

have the specified new property [`PaymentActionFailedException.Details`](https://syrve.github.io/front.api.sdk/v8/html/P_Resto_Front_Api_Exceptions_PaymentActionFailedException_Details.htm),
which will contain an exception message generated by another plugin in

- [`INotificationService.BeforeOrderBill`](https://syrve.github.io/front.api.sdk/v8/html/P_Resto_Front_Api_INotificationService_BeforeOrderBill.htm),
- [`IPaymentProcessor.PaySilently`](https://syrve.github.io/front.api.sdk/v8/html/M_Resto_Front_Api_IPaymentProcessor_PaySilently.htm),
- [`INotificationService.BeforeDoCheque`](https://syrve.github.io/front.api.sdk/v8/html/P_Resto_Front_Api_INotificationService_BeforeDoCheque.htm),
- [`IChequeTaskProcessor.BeforeDoCheckAction`](https://syrve.github.io/front.api.sdk/v8/html/M_Resto_Front_Api_Devices_IChequeTaskProcessor_BeforeDoCheckAction.htm),
- [`ICashRegister.DoCheque`](https://syrve.github.io/front.api.sdk/v8/html/M_Resto_Front_Api_Devices_ICashRegister_DoCheque.htm).
