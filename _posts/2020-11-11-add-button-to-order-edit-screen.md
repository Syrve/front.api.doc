---
title: Появилась возможность показать кнопку на экране редактирования заказа
layout: default
---

Начиная с V7Preview5 у плагина будет возможность добавить собственную кнопку в нижнюю панель экрана редактирования заказа (кроме доставок). 

Добавлен метод [`AddButtonToOrderEditScreen`](https://iiko.github.io/front.api.sdk/v7/html/M_Resto_Front_Api_IOperationService_AddButtonToOrderEditScreen.htm) со следующими параметрами:

* `caption` — текст кнопки,
* `iconGeometry` — иконка в формате [Path Markup](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/graphics-multimedia/path-markup-syntax?view=netframeworkdesktop-4.8) (можно без иконки),
* `callback` — обработчик нажатия на кнопку, в котором можно показывать диалоговые окна и вносить изменения в заказ.

Ограничения текущей версии:

* Метод необходимо вызвать заранее, до навигации на экран редактирования заказа, например, при запуске плагина. Однажды добавленная кнопка будет показываться при любом посещении экрана редактирования в течение сеанса работы, пока плагин не удалит кнопку, вызвав `Dispose` на возвращённом из метода объекте. Если на момент добавления или удаления кнопки уже открыт экран редактирования заказа, то изменение применится не сразу, а при следующем переходе на этот экран. Таким образом, кнопку пока можно добавить лишь разом на все заказы. В будущих версиях изменения будут применяться на лету, в том числе, к текущему экрану, что позволит показывать кнопку с учётом текущего состояния конкретного заказа.
* В зависимости от настроек в нижней панели экрана редактирования заказа может отображаться разное количество штатных кнопок, но от плагинов пока показывается только одна кнопка, даже если место позволяло бы показать больше. Если плагинных кнопок несколько, будет показана общая кнопка «Дополнения», по нажатию на которую откроется диалог выбора конкретной плагинной кнопки. В следующих версиях это будет исправлено — кнопки будут занимать всё свободное пространство, а диалог выбора понадобится, только если и тогда останутся непоместившиеся кнопки.
* Пока кнопку можно добавить лишь на экран редактирования заказа в ресторане и фастфуде. Экран редактирования доставочных заказов отличается тем, что не сохраняет изменения, пока пользователь не завершит редактирование нажатием «Сохранить», соответственно, плагин не видит промежуточное несохранённое состояние и не может вносить в него изменения. Плагинная кнопка без возможности менять доставочный заказ не имеет смысла, поэтому её пока и нет на экране доставки. 

Кроме того, кнопки уже можно добавлять на следующие экраны:

* [`AddButtonToPluginsMenu`](https://iiko.github.io/front.api.sdk/v7/html/M_Resto_Front_Api_IOperationService_AddButtonToPluginsMenu.htm) — меню «Дополнения» [главного экрана](https://iiko.github.io/front.api.sdk/v7/html/T_Resto_Front_Api_Data_Screens_IAdditionalOperationsScreen.htm)
* [`AddButtonToClosedOrderScreen`](https://iiko.github.io/front.api.sdk/v7/html/M_Resto_Front_Api_IOperationService_AddButtonToClosedOrderScreen.htm) — [экран закрытого заказа](https://iiko.github.io/front.api.sdk/v7/html/T_Resto_Front_Api_Data_Screens_IClosedOrderScreen.htm), здесь теперь тоже поддерживаются иконки
* [`AddButtonToProductsReturnScreen`](https://iiko.github.io/front.api.sdk/v7/html/M_Resto_Front_Api_IOperationService_AddButtonToProductsReturnScreen.htm) — экран возврата продуктов из заказа, закрытого в одной из прошлых кассовых смен