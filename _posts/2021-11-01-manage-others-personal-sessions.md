---
title: Появилась возможность открывать и закрывать личные смены без пин-кодов сотрудников
layout: default
---

Функции открытия и закрытия личных смен [были добавлены]({{ site.baseurl }}{% post_url 2019-12-27-open-close-personal-sessions %}) ранее, но они позволяли управлять личной сменой лишь того пользователя, от имени которого, авторизовавшись по пин-коду, действует плагин. Теперь можно управлять личными сменами и других пользователей тоже.

Для этого в методы [`OpenPersonalSession`](https://iiko.github.io/front.api.sdk/v7/html/M_Resto_Front_Api_IOperationService_OpenPersonalSession.htm) и [`ClosePersonalSession`](https://iiko.github.io/front.api.sdk/v7/html/M_Resto_Front_Api_IOperationService_ClosePersonalSession.htm) добавлен необязательный аргумент `user`. Если этот аргумент не указан, по умолчанию личная смена по-прежнему открывается или закрывается у пользователя, от имени которого действует плагин, этот пользователь, как и раньше, определяется по аргументу `credentials`, полученному в результате [авторизации](https://iiko.github.io/front.api.sdk/v7/html/M_Resto_Front_Api_IOperationService_AuthenticateByPin.htm) по пин-коду.

Теперь же, действуя от имени служебного пользователя с известным пин-кодом, плагин может открыть или закрыть личную смену другого пользователя, указанного как `user`, не зная его пин-кода. Для управления чужой личной сменой служебный пользователь должен обладать такими правами:

- `F_OPIN` «Подтверждать открытие и закрытие персональной смены по ПИН-коду» — для открытия чужой личной смены
- `F_KIS` «Принудительно закрывать личные смены» — для закрытия чужой личной смены
